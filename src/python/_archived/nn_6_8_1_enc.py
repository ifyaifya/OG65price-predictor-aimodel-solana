# NN 6→8→1 Encoder: hidden layer computation (TX1)
# Input: 6 bytes from /sol/1 (features 0-255)
# Output: 8 bytes to /sol/2 (hidden activations)

W=[33,-16,45,105,-18,-14,112,51,-34,26,-30,-32,12,-127,-112,-42,-57,17,-54,-86,107,-11,5,-76,-41,-8,-76,24,-47,-13,-32,123,-5,-93,57,-80,13,-124,-78,5,49,26,-11,-1,-96,-45,-39,55]
b=[-76,34,-48,-67,-36,-26,4,-127]

f=open("/sol/1","rb")
I=list(f.read(6))
f.close()

# Scale to signed
i0=I[0]-128
i1=I[1]-128
i2=I[2]-128
i3=I[3]-128
i4=I[4]-128
i5=I[5]-128

# Hidden neurons (unrolled)
h0=b[0]+i0*W[0]//128+i1*W[1]//128+i2*W[2]//128+i3*W[3]//128+i4*W[4]//128+i5*W[5]//128
h1=b[1]+i0*W[6]//128+i1*W[7]//128+i2*W[8]//128+i3*W[9]//128+i4*W[10]//128+i5*W[11]//128
h2=b[2]+i0*W[12]//128+i1*W[13]//128+i2*W[14]//128+i3*W[15]//128+i4*W[16]//128+i5*W[17]//128
h3=b[3]+i0*W[18]//128+i1*W[19]//128+i2*W[20]//128+i3*W[21]//128+i4*W[22]//128+i5*W[23]//128
h4=b[4]+i0*W[24]//128+i1*W[25]//128+i2*W[26]//128+i3*W[27]//128+i4*W[28]//128+i5*W[29]//128
h5=b[5]+i0*W[30]//128+i1*W[31]//128+i2*W[32]//128+i3*W[33]//128+i4*W[34]//128+i5*W[35]//128
h6=b[6]+i0*W[36]//128+i1*W[37]//128+i2*W[38]//128+i3*W[39]//128+i4*W[40]//128+i5*W[41]//128
h7=b[7]+i0*W[42]//128+i1*W[43]//128+i2*W[44]//128+i3*W[45]//128+i4*W[46]//128+i5*W[47]//128

# ReLU
if h0<0:h0=0
if h1<0:h1=0
if h2<0:h2=0
if h3<0:h3=0
if h4<0:h4=0
if h5<0:h5=0
if h6<0:h6=0
if h7<0:h7=0

# Clamp to byte
if h0>255:h0=255
if h1>255:h1=255
if h2>255:h2=255
if h3>255:h3=255
if h4>255:h4=255
if h5>255:h5=255
if h6>255:h6=255
if h7>255:h7=255

g=open("/sol/2","wb")
g.write(bytes([h0,h1,h2,h3,h4,h5,h6,h7]))
g.close()
1
